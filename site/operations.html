<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Nghi·ªáp v·ª• kho - Qu·∫£n l√Ω kho</title>
    <link rel="stylesheet" href="assets/css/styles.css" />
    <style>
      .operation-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
        margin: 20px 0;
      }
      .operation-card {
        background: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        border-left: 4px solid #3b82f6;
      }
      .operation-card h3 {
        margin-top: 0;
        color: #1e40af;
      }
      .quick-stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 15px;
        margin: 20px 0;
      }
      .stat-card {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 15px;
        border-radius: 8px;
        text-align: center;
      }
      .stat-value {
        font-size: 1.5rem;
        font-weight: bold;
        margin-bottom: 5px;
      }
      .stat-label {
        font-size: 0.9rem;
        opacity: 0.9;
      }
      .transaction-form {
        background: #f8fafc;
        padding: 20px;
        border-radius: 8px;
        margin: 15px 0;
      }
      .form-row {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin-bottom: 15px;
      }
      .form-group {
        display: flex;
        flex-direction: column;
      }
      .form-group label {
        font-weight: 600;
        margin-bottom: 5px;
        color: #374151;
      }
      .form-group input,
      .form-group select,
      .form-group textarea {
        padding: 8px 12px;
        border: 1px solid #d1d5db;
        border-radius: 6px;
        font-size: 14px;
      }
      .btn-group {
        display: flex;
        gap: 10px;
        margin-top: 15px;
      }
      .btn-success { background: #10b981; }
      .btn-warning { background: #f59e0b; }
      .btn-danger { background: #ef4444; }
      .btn-info { background: #06b6d4; }
      .inventory-table {
        margin-top: 20px;
      }
      .inventory-table th {
        background: #f3f4f6;
        font-weight: 600;
      }
      .low-stock { color: #ef4444; font-weight: bold; }
      .normal-stock { color: #10b981; }
      .high-stock { color: #3b82f6; }
    </style>
  </head>
  <body>
    <div class="layout">
      <aside class="sidebar">
        <a href="home.html">Trang ch·ªß</a>
        <a href="catalog.html">Danh m·ª•c</a>
        <a href="operations.html" class="active">Nghi·ªáp v·ª• kho</a>
        <a href="reports.html">B√°o c√°o</a>
        <a href="users.html" id="navUsers">Ng∆∞·ªùi d√πng</a>
        <a href="search.html">Tra c·ª©u</a>
        <a href="customers.html">Kh√°ch h√†ng</a>
        <a href="invoices.html">H√≥a ƒë∆°n</a>
      </aside>
      <main class="content">
        <header class="page-header">
          <h1>üè≠ Nghi·ªáp v·ª• kho</h1>
          <div class="grow"></div>
          <button id="btnRefresh" class="btn secondary">üîÑ L√†m m·ªõi</button>
        </header>

        <!-- Th·ªëng k√™ nhanh -->
        <section class="quick-stats">
          <div class="stat-card">
            <div class="stat-value" id="totalProducts">0</div>
            <div class="stat-label">T·ªïng s·∫£n ph·∫©m</div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="totalValue">0</div>
            <div class="stat-label">T·ªïng gi√° tr·ªã (VNƒê)</div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="lowStockCount">0</div>
            <div class="stat-label">S·∫Øp h·∫øt h√†ng</div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="todayTransactions">0</div>
            <div class="stat-label">Giao d·ªãch h√¥m nay</div>
          </div>
        </section>

        <!-- Tabs ch√≠nh -->
        <section class="tabs">
          <button class="tab active" data-tab="inbound">üì• Nh·∫≠p kho</button>
          <button class="tab" data-tab="outbound">üì§ Xu·∫•t kho</button>
          <button class="tab" data-tab="transfer">üîÑ Chuy·ªÉn kho</button>
          <button class="tab" data-tab="adjustment">‚öñÔ∏è ƒêi·ªÅu ch·ªânh</button>
          <button class="tab" data-tab="stocktake">üìã Ki·ªÉm k√™</button>
          <button class="tab" data-tab="inventory">üìä T·ªìn kho</button>
        </section>

        <!-- Nh·∫≠p kho -->
        <section id="inbound" class="panel">
          <h2>üì• Phi·∫øu nh·∫≠p kho</h2>
          <div class="transaction-form">
            <div class="form-row">
              <div class="form-group">
                <label for="inWh">Kho nh·∫≠p</label>
                <select id="inWh" required title="Ch·ªçn kho nh·∫≠p"></select>
              </div>
              <div class="form-group">
                <label for="inCode">M√£ phi·∫øu</label>
                <input id="inCode" placeholder="PN-YYYYMMDD-001" />
              </div>
              <div class="form-group">
                <label>Ng√†y nh·∫≠p</label>
                <input type="date" id="inDate" />
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label>Nh√† cung c·∫•p</label>
                <input id="inSupplier" placeholder="T√™n nh√† cung c·∫•p" />
              </div>
              <div class="form-group">
                <label>Ghi ch√∫</label>
                <textarea id="inNote" rows="2" placeholder="Ghi ch√∫ phi·∫øu nh·∫≠p"></textarea>
              </div>
            </div>
            <div class="btn-group">
              <button id="btnAddIn" class="btn primary">‚úÖ T·∫°o phi·∫øu nh·∫≠p</button>
              <button id="btnInClear" class="btn secondary">üóëÔ∏è X√≥a tr·∫Øng</button>
            </div>
          </div>
          
          <h3>Chi ti·∫øt h√†ng nh·∫≠p</h3>
          <div class="form-row">
            <div class="form-group">
              <label for="inProduct">S·∫£n ph·∫©m</label>
              <select id="inProduct" required title="Ch·ªçn s·∫£n ph·∫©m"></select>
            </div>
            <div class="form-group">
              <label for="inQty">S·ªë l∆∞·ª£ng</label>
              <input type="number" id="inQty" placeholder="0" min="1" step="1" required />
            </div>
            </div>
            <div class="form-group">
              <label>ƒê∆°n gi√°</label>
              <input type="number" id="inPrice" placeholder="0" min="0" step="1000" />
            </div>
                          <div class="form-group">
                <label>V·ªã tr√≠</label>
                <select id="inLocation" title="Ch·ªçn v·ªã tr√≠ trong kho"></select>
              </div>
          </div>
          <button id="btnInAddLine" class="btn btn-success">‚ûï Th√™m d√≤ng</button>
          
          <table class="table inventory-table" id="tblInLines">
            <thead>
              <tr>
                <th>S·∫£n ph·∫©m</th>
                <th>V·ªã tr√≠</th>
                <th class="right">S·ªë l∆∞·ª£ng</th>
                <th class="right">ƒê∆°n gi√°</th>
                <th class="right">Th√†nh ti·ªÅn</th>
                <th></th>
              </tr>
            </thead>
            <tbody></tbody>
            <tfoot>
              <tr>
                <td colspan="4" class="right"><strong>T·ªïng c·ªông:</strong></td>
                <td class="right" id="inTotal">0 VNƒê</td>
                <td></td>
              </tr>
            </tfoot>
          </table>
        </section>

        <!-- Xu·∫•t kho -->
        <section id="outbound" class="panel hidden">
          <h2>üì§ Phi·∫øu xu·∫•t kho</h2>
          <div class="transaction-form">
            <div class="form-row">
              <div class="form-group">
                <label for="outWh">Kho xu·∫•t</label>
                <select id="outWh" required title="Ch·ªçn kho xu·∫•t"></select>
              </div>
              <div class="form-group">
                <label for="outCode">M√£ phi·∫øu</label>
                <input id="outCode" placeholder="PX-YYYYMMDD-001" />
              </div>
              </div>
              <div class="form-group">
                <label>Ng√†y xu·∫•t</label>
                <input type="date" id="outDate" />
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label>Kh√°ch h√†ng</label>
                <input id="outCustomer" placeholder="T√™n kh√°ch h√†ng" />
              </div>
              <div class="form-group">
                <label>Ghi ch√∫</label>
                <textarea id="outNote" rows="2" placeholder="Ghi ch√∫ phi·∫øu xu·∫•t"></textarea>
              </div>
            </div>
            <div class="btn-group">
              <button id="btnAddOut" class="btn primary">‚úÖ T·∫°o phi·∫øu xu·∫•t</button>
              <button id="btnOutClear" class="btn secondary">üóëÔ∏è X√≥a tr·∫Øng</button>
            </div>
          </div>
          
          <h3>Chi ti·∫øt h√†ng xu·∫•t</h3>
          <div class="form-row">
            <div class="form-group">
              <label for="outProduct">S·∫£n ph·∫©m</label>
              <select id="outProduct" required title="Ch·ªçn s·∫£n ph·∫©m"></select>
            </div>
            <div class="form-group">
              <label for="outQty">S·ªë l∆∞·ª£ng</label>
              <input type="number" id="outQty" placeholder="0" min="0" step="1" required />
            </div>
            </div>
            <div class="form-group">
              <label>T·ªìn kho hi·ªán t·∫°i</label>
              <input type="text" id="outCurrentStock" readonly />
            </div>
                          <div class="form-group">
                <label>V·ªã tr√≠</label>
                <select id="outLocation" title="Ch·ªçn v·ªã tr√≠ trong kho"></select>
              </div>
          </div>
          <button id="btnOutAddLine" class="btn btn-success">‚ûï Th√™m d√≤ng</button>
          
          <table class="table inventory-table" id="tblOutLines">
            <thead>
              <tr>
                <th>S·∫£n ph·∫©m</th>
                <th>V·ªã tr√≠</th>
                <th class="right">S·ªë l∆∞·ª£ng</th>
                <th class="right">T·ªìn kho</th>
                <th class="right">Tr·∫°ng th√°i</th>
                <th></th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </section>

        <!-- Chuy·ªÉn kho -->
        <section id="transfer" class="panel hidden">
          <h2>üîÑ Chuy·ªÉn kho</h2>
          <div class="transaction-form">
            <div class="form-row">
              <div class="form-group">
                <label>Kho ngu·ªìn</label>
                <select id="transferFrom" required></select>
              </div>
              <div class="form-group">
                <label for="transferTo">Kho ƒë√≠ch</label>
                <select id="transferTo" required title="Ch·ªçn kho ƒë√≠ch"></select>
              </div>
              <div class="form-group">
                <label for="transferCode">M√£ phi·∫øu</label>
                <input id="transferCode" placeholder="CK-YYYYMMDD-001" />
              </div>
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label>Ng√†y chuy·ªÉn</label>
                <input type="date" id="transferDate" />
              </div>
              <div class="form-group">
                <label>L√Ω do chuy·ªÉn</label>
                <select id="transferReason">
                  <option value="T·ªëi ∆∞u kho">T·ªëi ∆∞u kho</option>
                  <option value="B·∫£o tr√¨">B·∫£o tr√¨</option>
                  <option value="M·ªü r·ªông">M·ªü r·ªông</option>
                  <option value="Kh√°c">Kh√°c</option>
                </select>
              </div>
              <div class="form-group">
                <label>Ghi ch√∫</label>
                <textarea id="transferNote" rows="2" placeholder="Ghi ch√∫ chuy·ªÉn kho"></textarea>
              </div>
            </div>
            <div class="btn-group">
              <button id="btnCreateTransfer" class="btn btn-info">üîÑ T·∫°o phi·∫øu chuy·ªÉn</button>
              <button id="btnTransferClear" class="btn secondary">üóëÔ∏è X√≥a tr·∫Øng</button>
            </div>
          </div>
          
          <h3>Chi ti·∫øt chuy·ªÉn kho</h3>
          <div class="form-row">
            <div class="form-group">
              <label>S·∫£n ph·∫©m</label>
              <select id="transferProduct" required></select>
            </div>
            <div class="form-group">
              <label>S·ªë l∆∞·ª£ng</label>
              <input type="number" id="transferQty" placeholder="0" min="0" step="1" required />
            </div>
            <div class="form-group">
              <label>T·ªìn kho ngu·ªìn</label>
              <input type="text" id="transferFromStock" readonly />
            </div>
                          <div class="form-group">
                <label>V·ªã tr√≠ ngu·ªìn</label>
                <select id="transferFromLocation" title="Ch·ªçn v·ªã tr√≠ ngu·ªìn"></select>
              </div>
              <div class="form-group">
                <label>V·ªã tr√≠ ƒë√≠ch</label>
                <select id="transferToLocation" title="Ch·ªçn v·ªã tr√≠ ƒë√≠ch"></select>
              </div>
          </div>
          <button id="btnTransferAddLine" class="btn btn-success">‚ûï Th√™m d√≤ng</button>
          
          <table class="table inventory-table" id="tblTransferLines">
            <thead>
              <tr>
                <th>S·∫£n ph·∫©m</th>
                <th>V·ªã tr√≠ ngu·ªìn</th>
                <th>V·ªã tr√≠ ƒë√≠ch</th>
                <th class="right">S·ªë l∆∞·ª£ng</th>
                <th class="right">T·ªìn ngu·ªìn</th>
                <th></th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </section>

        <!-- ƒêi·ªÅu ch·ªânh t·ªìn kho -->
        <section id="adjustment" class="panel hidden">
          <h2>‚öñÔ∏è ƒêi·ªÅu ch·ªânh t·ªìn kho</h2>
          <div class="transaction-form">
            <div class="form-row">
              <div class="form-group">
                <label for="adjustWh">Kho</label>
                <select id="adjustWh" required title="Ch·ªçn kho"></select>
              </div>
              <div class="form-group">
                <label for="adjustCode">M√£ phi·∫øu</label>
                <input id="adjustCode" placeholder="DC-YYYYMMDD-001" autocomplete="off" />
              </div>
              </div>
              <div class="form-group">
                <label>Lo·∫°i ƒëi·ªÅu ch·ªânh</label>
                <select id="adjustType">
                  <option value="INCREASE">TƒÉng t·ªìn kho</option>
                  <option value="DECREASE">Gi·∫£m t·ªìn kho</option>
                  <option value="CORRECT">S·ª≠a ch·ªØa</option>
                </select>
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label>Ng√†y ƒëi·ªÅu ch·ªânh</label>
                <input type="date" id="adjustDate" />
              </div>
              <div class="form-group">
                <label>L√Ω do</label>
                <select id="adjustReason">
                  <option value="H·ªèng h√≥c">H·ªèng h√≥c</option>
                  <option value="M·∫•t m√°t">M·∫•t m√°t</option>
                  <option value="Sai s√≥t">Sai s√≥t</option>
                  <option value="Ki·ªÉm k√™">Ki·ªÉm k√™</option>
                  <option value="Kh√°c">Kh√°c</option>
                </select>
              </div>
              <div class="form-group">
                <label>Ghi ch√∫</label>
                <textarea id="adjustNote" rows="2" placeholder="Ghi ch√∫ ƒëi·ªÅu ch·ªânh"></textarea>
              </div>
            </div>
            <div class="btn-group">
              <button id="btnCreateAdjustment" class="btn btn-warning">‚öñÔ∏è T·∫°o phi·∫øu ƒëi·ªÅu ch·ªânh</button>
              <button id="btnAdjustClear" class="btn secondary">üóëÔ∏è X√≥a tr·∫Øng</button>
            </div>
          </div>
          
          <h3>Chi ti·∫øt ƒëi·ªÅu ch·ªânh</h3>
          <div class="form-row">
            <div class="form-group">
              <label>S·∫£n ph·∫©m</label>
              <select id="adjustProduct" required></select>
            </div>
            <div class="form-group">
              <label>T·ªìn kho hi·ªán t·∫°i</label>
              <input type="text" id="adjustCurrentStock" readonly />
            </div>
            <div class="form-group">
              <label>S·ªë l∆∞·ª£ng ƒëi·ªÅu ch·ªânh</label>
              <input type="number" id="adjustQty" placeholder="0" step="1" required />
            </div>
                          <div class="form-group">
                <label>V·ªã tr√≠</label>
                <select id="adjustLocation" title="Ch·ªçn v·ªã tr√≠ trong kho"></select>
              </div>
          </div>
          <button id="btnAdjustAddLine" class="btn btn-success">‚ûï Th√™m d√≤ng</button>
          
          <table class="table inventory-table" id="tblAdjustLines">
            <thead>
              <tr>
                <th>S·∫£n ph·∫©m</th>
                <th>V·ªã tr√≠</th>
                <th class="right">T·ªìn c≈©</th>
                <th class="right">ƒêi·ªÅu ch·ªânh</th>
                <th class="right">T·ªìn m·ªõi</th>
                <th></th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </section>

        <!-- Ki·ªÉm k√™ -->
        <section id="stocktake" class="panel hidden">
          <h2>üìã Ki·ªÉm k√™ kho</h2>
          <div class="transaction-form">
            <div class="form-row">
              <div class="form-group">
                <label>Kho ki·ªÉm k√™</label>
                <select id="kkWh" required></select>
              </div>
              <div class="form-group">
                <label>M√£ ki·ªÉm k√™</label>
                <input id="kkCode" placeholder="KK-YYYYMMDD-001" />
              </div>
              <div class="form-group">
                <label>Ng√†y ki·ªÉm k√™</label>
                <input type="date" id="kkDate" />
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label>Ng∆∞·ªùi ki·ªÉm k√™</label>
                <input id="kkPerson" placeholder="T√™n ng∆∞·ªùi ki·ªÉm k√™" />
              </div>
              <div class="form-group">
                <label>Ghi ch√∫</label>
                <textarea id="kkNote" rows="2" placeholder="Ghi ch√∫ ki·ªÉm k√™"></textarea>
              </div>
            </div>
            <div class="btn-group">
              <button id="btnRunKK" class="btn btn-info">üìã B·∫Øt ƒë·∫ßu ki·ªÉm k√™</button>
              <button id="btnKKExport" class="btn btn-success">üì• Xu·∫•t Excel</button>
              <button id="btnKKClear" class="btn secondary">üóëÔ∏è X√≥a tr·∫Øng</button>
            </div>
          </div>
          
          <table class="table inventory-table" id="tblKK">
            <thead>
              <tr>
                <th>S·∫£n ph·∫©m</th>
                <th>V·ªã tr√≠</th>
                <th class="right">H·ªá th·ªëng</th>
                <th class="right">Th·ª±c t·∫ø</th>
                <th class="right">Ch√™nh l·ªách</th>
                <th class="right">Ghi ch√∫</th>
                <th></th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </section>

        <!-- B√°o c√°o t·ªìn kho -->
        <section id="inventory" class="panel hidden">
          <h2>üìä B√°o c√°o t·ªìn kho</h2>
          <div class="transaction-form">
            <div class="form-row">
              <div class="form-group">
                <label>Kho</label>
                <select id="reportWh">
                  <option value="">T·∫•t c·∫£ kho</option>
                </select>
              </div>
              <div class="form-group">
                <label>Nh√≥m s·∫£n ph·∫©m</label>
                <select id="reportGroup">
                  <option value="">T·∫•t c·∫£ nh√≥m</option>
                </select>
              </div>
              <div class="form-group">
                <label>Tr·∫°ng th√°i t·ªìn</label>
                <select id="reportStatus">
                  <option value="">T·∫•t c·∫£</option>
                  <option value="low">S·∫Øp h·∫øt (‚â§5)</option>
                  <option value="normal">B√¨nh th∆∞·ªùng (6-50)</option>
                  <option value="high">Cao (>50)</option>
                </select>
              </div>
            </div>
            <div class="btn-group">
              <button id="btnGenerateReport" class="btn btn-info">üìä T·∫°o b√°o c√°o</button>
              <button id="btnExportReport" class="btn btn-success">üì• Xu·∫•t Excel</button>
              <button id="btnPrintReport" class="btn btn-warning">üñ®Ô∏è In b√°o c√°o</button>
            </div>
          </div>
          
          <div class="operation-grid">
            <div class="operation-card">
              <h3>üìà Th·ªëng k√™ t·ªïng quan</h3>
              <div id="inventoryStats"></div>
            </div>
            <div class="operation-card">
              <h3>‚ö†Ô∏è C·∫£nh b√°o</h3>
              <div id="inventoryAlerts"></div>
            </div>
          </div>
          
          <table class="table inventory-table" id="tblInventory">
            <thead>
              <tr>
                <th>S·∫£n ph·∫©m</th>
                <th>Kho</th>
                <th>V·ªã tr√≠</th>
                <th class="right">T·ªìn kho</th>
                <th class="right">ƒê∆°n gi√°</th>
                <th class="right">Gi√° tr·ªã</th>
                <th class="right">Tr·∫°ng th√°i</th>
                <th></th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </section>
      </main>
    </div>

    <script src="assets/js/storage.js"></script>
    <script src="assets/js/data.js"></script>
    <script src="assets/js/auth.js"></script>
    <script>
      guardAuthenticated();
      const current = getCurrentUser();
      if (current.role !== 'Admin') document.getElementById('navUsers').style.display = 'none';

      // Kh·ªüi t·∫°o d·ªØ li·ªáu
      const products = storage.get('products', []);
      const warehouses = storage.get('warehouses', []);
      const locations = storage.get('locations', []);
      const transactions = storage.get('transactions', []);

      // C·∫≠p nh·∫≠t th·ªëng k√™ nhanh
      function updateQuickStats() {
        const totalProducts = products.length;
        const totalValue = products.reduce((sum, p) => sum + (p.price || 0), 0);
        const lowStockCount = products.filter(p => getOnHand(p.id) <= 5).length;
        const todayTransactions = transactions.filter(t => 
          new Date(t.createdAt).toDateString() === new Date().toDateString()
        ).length;

        document.getElementById('totalProducts').textContent = totalProducts.toLocaleString('vi-VN');
        document.getElementById('totalValue').textContent = totalValue.toLocaleString('vi-VN');
        document.getElementById('lowStockCount').textContent = lowStockCount.toLocaleString('vi-VN');
        document.getElementById('todayTransactions').textContent = todayTransactions.toLocaleString('vi-VN');
      }

      // H√†m t√≠nh t·ªìn kho
      function getOnHand(productId, warehouseId = null) {
        let qty = 0;
        transactions.forEach(tx => {
          if (!warehouseId || tx.warehouseId === warehouseId) {
            tx.lines.forEach(line => {
              if (line.productId === productId) {
                qty += (tx.type === 'IN' ? line.qty : -line.qty);
              }
            });
          }
        });
        return Math.max(0, qty);
      }

      // Kh·ªüi t·∫°o form
      function initializeForms() {
        // Populate warehouse selects
        const warehouseOptions = warehouses.map(w => 
          `<option value="${w.id}">${w.code} - ${w.name}</option>`
        ).join('');
        
        ['inWh', 'outWh', 'transferFrom', 'transferTo', 'adjustWh', 'kkWh'].forEach(id => {
          if (document.getElementById(id)) {
            document.getElementById(id).innerHTML = warehouseOptions;
          }
        });

        // Populate product selects
        const productOptions = products.map(p => 
          `<option value="${p.id}">${p.code} - ${p.name}</option>`
        ).join('');
        
        ['inProduct', 'outProduct', 'transferProduct', 'adjustProduct'].forEach(id => {
          if (document.getElementById(id)) {
            document.getElementById(id).innerHTML = productOptions;
          }
        });

        // Set default dates
        const today = new Date().toISOString().split('T')[0];
        ['inDate', 'outDate', 'transferDate', 'adjustDate', 'kkDate'].forEach(id => {
          if (document.getElementById(id)) {
            document.getElementById(id).value = today;
          }
        });
      }

      // Tab switching
      document.querySelectorAll('.tab').forEach(tab => {
        tab.addEventListener('click', () => {
          document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
          document.querySelectorAll('.panel').forEach(p => p.classList.add('hidden'));
          
          tab.classList.add('active');
          document.getElementById(tab.dataset.tab).classList.remove('hidden');
        });
      });

      // Initialize
      document.addEventListener('DOMContentLoaded', function() {
        initializeForms();
        updateQuickStats();
      });

      // Refresh button
      document.getElementById('btnRefresh').addEventListener('click', function() {
        updateQuickStats();
        alert('ƒê√£ l√†m m·ªõi d·ªØ li·ªáu!');
      });
    </script>
  </body>
</html>


